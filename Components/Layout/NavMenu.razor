@*
    Navigation Menu Component - Sidebar Navigation
    ==========================================
    Purpose: Provides the main navigation menu for authenticated users
    
    Navigation Structure:
    - Vertical sidebar layout with icon-based navigation
    - Hierarchical organization of app sections
    - Active state indication for current page
    - Responsive scrollable design
*@
@using JournalApp.Services
@implements IDisposable
@inject UserService UserSession
@inject NavigationManager Nav

<!-- Navigation Menu (only shown when logged in) -->
@if (UserSession.IsLoggedIn)
{
    <div class="nav-scrollable">
        <nav class="flex-column">

            <!-- Home Navigation -->
            <div class="nav-item px-3">
                <NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
                    <img src="/icons/home.svg" width="18" height="18" alt="Home" class="nav-icon" />
                    Home
                </NavLink>
            </div>

            <!-- Dashboard Navigation -->
            <div class="nav-item px-3">
                <NavLink class="nav-link" href="/dashboard">
                    <img src="/icons/dashboard.svg" width="18" height="18" alt="Dashboard" class="nav-icon" />
                    Dashboard
                </NavLink>
            </div>

            <!-- Calendar Navigation -->
            <div class="nav-item px-3">
                <NavLink class="nav-link" href="/calendar">
                    <img src="/icons/calendar.svg" width="18" height="18" alt="Calendar" class="nav-icon" />
                    Calendar
                </NavLink>
            </div>

            <!-- Entries Navigation -->
            <div class="nav-item px-3">
                <NavLink class="nav-link" href="/entries">
                    <img src="/icons/document.svg" width="18" height="18" alt="Entries" class="nav-icon" />
                    Entries
                </NavLink>
            </div>

            <!-- New Entry Navigation -->
            <div class="nav-item px-3">
                <NavLink class="nav-link" href="/new-entry">
                    <img src="/icons/plus.svg" width="18" height="18" alt="New Entry" class="nav-icon" />
                    New Entry
                </NavLink>
            </div>

            <!-- Settings Navigation -->
            <div class="nav-item px-3">
                <NavLink class="nav-link" href="/settings">
                    <img src="/icons/settings.svg" width="18" height="18" alt="Settings" class="nav-icon" />
                    Settings
                </NavLink>
            </div>
        </nav>
    </div>
}

@code {
    /// Initializes the navigation menu and subscribes to user state changes
    protected override void OnInitialized()
    {
        UserSession.OnChange += HandleUserStateChanged;
    }

    /// Handles user state changes (login/logout) and updates the navigation UI
    private void HandleUserStateChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    /// Cleanup: Unsubscribes from user state change events to prevent memory leaks
    public void Dispose()
    {
        UserSession.OnChange -= HandleUserStateChanged;
    }
}
